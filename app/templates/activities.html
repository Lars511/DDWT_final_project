{% extends "base.html" %}
{% block content %}

<div class="activities-page">

    <div class="activities-header">
        <h1>Activities</h1>
        <a class="btn-create" href="{{ url_for('create_activity') }}">
            âž• Create new activity
        </a>
    </div>

    {% if activities %}
    <table class="activities-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Activity</th>
                <th>Description</th>
                <th>Location</th>
                <th>Date</th>
                <th>Time</th>
                <th>Participants</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for activity in activities %}
            <tr>
                <td>{{ activity.title }}</td>
                <td>{{ activity.get_category().name }}</td>
                <td>{{ activity.get_activity_type().name }}</td>
                <td>{{ activity.description }}</td>
                <td>{{ activity.location }}</td>
                <td>{{ activity.activity_date }}</td>
                <td>{{ activity.activity_time }}</td>
                <td>
                    {{ activity.get_participant_count() }} / {{ activity.max_participants }}
                </td>
                <td class="actions">
                    {% if activity.creator_id == current_user.id %}
                        <a href="{{ url_for('edit_activity', id=activity.id) }}" class="btn-edit">Edit</a>

                        <form method="POST" action="{{ url_for('delete_activity', id=activity.id) }}">
                            <button class="btn-delete" type="submit">Delete</button>
                        </form>
                    {% endif %}

                    {% if activity.has_user_joined(current_user.id) %}
                        <form method="POST" action="{{ url_for('leave_activity', id=activity.id) }}">
                            <button class="btn-leave" type="submit">Leave</button>
                        </form>
                    {% elif not activity.is_full() %}
                        <form method="POST" action="{{ url_for('join_activity', id=activity.id) }}">
                            <button class="btn-join" type="submit">Join</button>
                        </form>
                    {% else %}
                        <span class="full-label">Full</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p>No activities yet.</p>
    {% endif %}

</div>

{% endblock %}
